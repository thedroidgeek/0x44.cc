<!DOCTYPE html>
<html lang="en-us">
  <head>
    <link href="https://gmpg.org/xfn/11" rel="profile" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />

    <!-- Enable responsiveness on mobile devices-->
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1"
    />

    <title>
      1-click RCE with Skype Web Plugin and Qt apps &middot; 0x44.cc
    </title>

    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/main.css" />

    <!-- Icons -->
    <link
      rel="apple-touch-icon-precomposed"
      sizes="144x144"
      href="/favicon.png"
    />
    <link rel="shortcut icon" href="/favicon.ico" />

    <!-- RSS -->
    <link
      rel="alternate"
      type="application/rss+xml"
      title="RSS"
      href="/feed.xml"
    />

    <!-- Additional head bits without overriding original head -->
  </head>

  <body class="post">
    <script src="/assets/js/anchor.min.js"></script>
    <script>
      // IE support
      if (window.MSInputMethodContext && document.documentMode) {
        document.write(
          '<script src="/assets/js/ie11CustomProperties.min.js"><\x2fscript>'
        );
      }
      // progress bar
      prog = document.createElement("div");
      prog.setAttribute("id", "progress-bar");
      prog.style.setProperty("--progress", "0%");
      document.body.insertBefore(prog, document.body.childNodes[0]);
      const article = document.querySelector(".post");
      const progressBar = document.querySelector("#progress-bar");
      document.addEventListener("scroll", function () {
        const articleScroll = pageYOffset - article.offsetTop;
        const height =
          document.documentElement.scrollHeight -
          innerHeight -
          article.offsetTop;
        const readPercent = (articleScroll / height) * 100;
        if (readPercent > 0) {
          progressBar.style.setProperty("--progress", readPercent + "%");
        } else {
          progressBar.style.setProperty("--progress", "0%");
        }
      });

      // initialize AnchorJS
      document.addEventListener("DOMContentLoaded", function (event) {
        anchors.add(".post-body h3, .post-body h4");
        anchors.options.placement = "left";
      });
    </script>

    <div id="sidebar">
      <header>
        <div class="site-title">
          <a href="/">
            <span class="back-arrow icon"
              ><svg
                fill="#000000"
                height="24"
                viewBox="0 0 24 24"
                width="24"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path d="M0 0h24v24H0z" fill="none" />
                <path
                  d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"
                /></svg
            ></span>

            <span id="site-title">0x44.cc</span>
          </a>
        </div>
        <p class="lead">InfoSec, Reverse Engineering, and more (soon&trade;)</p>
      </header>
      <nav id="sidebar-nav-links">
        <a class="home-link" href="/">Home</a>

        <a class="page-link" href="/about.html">whoami</a>

        <a class="category-link" href="/infosec/">InfoSec</a>

        <a class="category-link" href="/reversing/">Reverse Engineering</a>

        <a class="category-link" href="/automation/">Automation</a>

        <!-- Optional additional links to insert in sidebar nav -->
      </nav>

      <nav id="sidebar-icon-links">
        <a
          id="subscribe-link"
          class="icon"
          title="Subscribe"
          aria-label="Subscribe"
          href="/feed.xml"
        >
          <svg
            fill="#000000"
            height="24"
            viewBox="0 0 24 24"
            width="24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path d="M0 0h24v24H0z" fill="none" />
            <circle cx="6.18" cy="17.82" r="2.18" />
            <path
              d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"
            />
          </svg>
        </a>

        <a
          id="github-link"
          class="icon"
          title="GitHub"
          aria-label="GitHub"
          href="https://github.com/thedroidgeek"
          target="_blank"
          rel="noopener noreferrer"
        >
          <svg
            version="1.1"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            height="24"
            width="24"
          >
            <path
              d="M12 2c6.625 0 12 5.375 12 12 0 5.297-3.437 9.797-8.203 11.391-0.609 0.109-0.828-0.266-0.828-0.578 0-0.391 0.016-1.687 0.016-3.297 0-1.125-0.375-1.844-0.812-2.219 2.672-0.297 5.484-1.313 5.484-5.922 0-1.313-0.469-2.375-1.234-3.219 0.125-0.313 0.531-1.531-0.125-3.187-1-0.313-3.297 1.234-3.297 1.234-0.953-0.266-1.984-0.406-3-0.406s-2.047 0.141-3 0.406c0 0-2.297-1.547-3.297-1.234-0.656 1.656-0.25 2.875-0.125 3.187-0.766 0.844-1.234 1.906-1.234 3.219 0 4.594 2.797 5.625 5.469 5.922-0.344 0.313-0.656 0.844-0.766 1.609-0.688 0.313-2.438 0.844-3.484-1-0.656-1.141-1.844-1.234-1.844-1.234-1.172-0.016-0.078 0.734-0.078 0.734 0.781 0.359 1.328 1.75 1.328 1.75 0.703 2.141 4.047 1.422 4.047 1.422 0 1 0.016 1.937 0.016 2.234 0 0.313-0.219 0.688-0.828 0.578-4.766-1.594-8.203-6.094-8.203-11.391 0-6.625 5.375-12 12-12zM4.547 19.234c0.031-0.063-0.016-0.141-0.109-0.187-0.094-0.031-0.172-0.016-0.203 0.031-0.031 0.063 0.016 0.141 0.109 0.187 0.078 0.047 0.172 0.031 0.203-0.031zM5.031 19.766c0.063-0.047 0.047-0.156-0.031-0.25-0.078-0.078-0.187-0.109-0.25-0.047-0.063 0.047-0.047 0.156 0.031 0.25 0.078 0.078 0.187 0.109 0.25 0.047zM5.5 20.469c0.078-0.063 0.078-0.187 0-0.297-0.063-0.109-0.187-0.156-0.266-0.094-0.078 0.047-0.078 0.172 0 0.281s0.203 0.156 0.266 0.109zM6.156 21.125c0.063-0.063 0.031-0.203-0.063-0.297-0.109-0.109-0.25-0.125-0.313-0.047-0.078 0.063-0.047 0.203 0.063 0.297 0.109 0.109 0.25 0.125 0.313 0.047zM7.047 21.516c0.031-0.094-0.063-0.203-0.203-0.25-0.125-0.031-0.266 0.016-0.297 0.109s0.063 0.203 0.203 0.234c0.125 0.047 0.266 0 0.297-0.094zM8.031 21.594c0-0.109-0.125-0.187-0.266-0.172-0.141 0-0.25 0.078-0.25 0.172 0 0.109 0.109 0.187 0.266 0.172 0.141 0 0.25-0.078 0.25-0.172zM8.937 21.438c-0.016-0.094-0.141-0.156-0.281-0.141-0.141 0.031-0.234 0.125-0.219 0.234 0.016 0.094 0.141 0.156 0.281 0.125s0.234-0.125 0.219-0.219z"
            ></path>
          </svg>
        </a>

        <a
          id="linkedin-link"
          class="icon"
          title="LinkedIn"
          aria-label="LinkedIn"
          href="https://linkedin.com/in/thedroidgeek"
          target="_blank"
          rel="noopener"
        >
          <svg
            version="1.1"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            height="24"
            width="24"
          >
            <path
              d="M 24.007812 14.597656 L 24.007812 23.472656 L 18.859375 23.472656 L 18.859375 15.191406 C 18.859375 13.113281 18.117188 11.691406 16.253906 11.691406 C 14.832031 11.691406 13.988281 12.648438 13.613281 13.574219 C 13.480469 13.90625 13.445312 14.367188 13.445312 14.828125 L 13.445312 23.472656 L 8.296875 23.472656 C 8.296875 23.472656 8.367188 9.449219 8.296875 7.996094 L 13.441406 7.996094 L 13.441406 10.1875 C 13.433594 10.207031 13.417969 10.222656 13.410156 10.238281 L 13.441406 10.238281 L 13.441406 10.1875 C 14.128906 9.136719 15.347656 7.632812 18.082031 7.632812 C 21.46875 7.632812 24.007812 9.84375 24.007812 14.597656 Z M 2.914062 0.535156 C 1.152344 0.535156 0 1.6875 0 3.207031 C 0 4.691406 1.117188 5.882812 2.84375 5.882812 L 2.878906 5.882812 C 4.671875 5.882812 5.789062 4.691406 5.789062 3.207031 C 5.757812 1.6875 4.671875 0.535156 2.914062 0.535156 Z M 0.304688 23.472656 L 5.449219 23.472656 L 5.449219 7.996094 L 0.304688 7.996094 Z M 0.304688 23.472656 "
            />
          </svg>
        </a>
      </nav>

      <p>
        &copy; 2024.
        <a href="/LICENSE.md">MIT License.</a>
      </p>
    </div>

    <main class="container">
      <header>
        <h1 class="post-title">
          1-click RCE with Skype Web Plugin and Qt apps
        </h1>
      </header>
      <div class="content">
        <div class="post-meta">
          <span class="post-date">28 May 2019</span>
          <span class="post-categories">
            &bull;

            <a href="/infosec/">
              <svg
                version="1.1"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                height="24"
                width="24"
              >
                <path
                  d="M 9.644531 18.515625 L 9.878906 18.726562 L 9.878906 20.125 L 11.296875 20.125 L 11.296875 18.707031 L 12.703125 18.707031 L 12.703125 20.125 L 14.121094 20.125 L 14.121094 18.726562 L 14.355469 18.515625 C 15.105469 17.847656 15.53125 16.886719 15.53125 15.882812 C 15.53125 13.933594 13.949219 12.351562 12 12.351562 C 10.050781 12.351562 8.46875 13.933594 8.46875 15.882812 C 8.46875 16.886719 8.894531 17.847656 9.644531 18.515625 Z M 12.710938 15.179688 L 14.117188 15.179688 L 14.117188 16.585938 L 12.710938 16.585938 Z M 9.882812 15.179688 L 11.292969 15.179688 L 11.292969 16.585938 L 9.882812 16.585938 Z M 9.882812 15.179688 "
                />
                <path
                  d="M 11.882812 4.238281 L 10.378906 0 L 0 0 L 0 7.0625 L 24 7.0625 L 24 4.234375 Z M 11.882812 4.238281 "
                />
                <path
                  d="M 0 8.46875 L 0 24 L 24 24 L 24 8.46875 C 23.078125 8.46875 0.921875 8.46875 0 8.46875 Z M 6.152344 10.945312 L 8.78125 12.140625 C 10.632812 10.542969 13.367188 10.542969 15.21875 12.140625 L 17.847656 10.945312 L 21.179688 10.945312 L 21.179688 12.351562 L 18.152344 12.351562 L 16.175781 13.25 C 16.539062 13.824219 16.789062 14.476562 16.890625 15.179688 L 18.769531 15.179688 L 19.976562 13.972656 L 20.96875 14.96875 L 19.351562 16.585938 L 16.890625 16.585938 C 16.816406 17.078125 16.671875 17.558594 16.460938 18.003906 L 19.398438 18.003906 L 21.023438 20.035156 L 19.921875 20.910156 L 18.722656 19.410156 L 15.527344 19.410156 L 15.527344 21.53125 L 8.472656 21.53125 L 8.472656 19.410156 L 5.277344 19.410156 L 4.078125 20.910156 L 2.976562 20.035156 L 4.601562 18.003906 L 7.539062 18.003906 C 7.328125 17.558594 7.183594 17.078125 7.109375 16.585938 L 4.648438 16.585938 L 3.03125 14.96875 L 4.023438 13.972656 L 5.230469 15.179688 L 7.109375 15.179688 C 7.210938 14.476562 7.460938 13.824219 7.824219 13.25 L 5.847656 12.351562 L 2.820312 12.351562 L 2.820312 10.945312 Z M 6.152344 10.945312 "
                />
              </svg>

              InfoSec
            </a>
          </span>
        </div>

        <div class="post-body">
          <h3 id="context">Context</h3>

          <p>
            Earlier this year, I’ve heard that you could send links with custom
            URI schemes through Discord, that can trigger without the user’s
            confirmation when using desktop clients.
          </p>

          <p>
            I’ve been experimenting with URI schemes ever since, I wanted to see
            how far I can push it in terms of exploitability, and I’ve found
            that you could do all sort of fun things in windows - stuff like
            opening the action center or the task switcher, etc. But I have
            quickly lost interest however, since I’ve realized there was a bunch
            of filters that Discord has in place, likely due to various reports
            from researchers, that prevent a lot of the known ‘malicious’ scheme
            links from triggering (though I still don’t understand Discord’s
            decision of not simply using a whitelist for schemes instead of
            adding regex filters ¯\_(ツ)_/¯).
          </p>

          <p>
            <strong><em>Update</em></strong
            >: Discord has now started
            <a
              href="https://i.0x44.cc/b/discord-proto-warn.png"
              target="_blank"
              rel="noopener noreferrer"
              >warning</a
            >
            people when clicking on protocol links.
          </p>

          <p>
            A couple of months later, it hit the headlines that Electronic Arts’
            digital distribution platform, Origin, was found to be vulnerable to
            an RCE through a URI scheme. This was due to an AngularJS template
            injection, that was met with some bad implementation that exposed
            Qt’s common desktop services to JavaScript - more on this
            <a
              href="https://zeropwn.github.io/2019-05-13-xss-to-rce/"
              target="_blank"
              rel="noopener noreferrer"
              >here</a
            >.
          </p>

          <p>
            A
            <a
              href="https://zeropwn.github.io/2019-05-22-fun-with-uri-handlers/"
              target="_blank"
              rel="noopener noreferrer"
              >second blog post</a
            >
            from the same researcher emerged, a couple of days later, where he
            found another ‘flaw’ in Origin that can be leveraged for RCE, but
            unlike the first one, this one wasn’t exactly new - it was merely
            Qt’s plugin feature which can be abused with the right conditions to
            load arbitrary .dll files through SMB shares …
          </p>

          <p>
            Following that blog post, I’ve re-enumerated the URL protocols on my
            machine (using
            <a
              href="https://github.com/ChiChou/LookForSchemes"
              target="_blank"
              rel="noopener noreferrer"
              >this</a
            >), and went back to fiddling with URI schemes once more, and soon
            enough, I was able to find an interesting attack vector …
          </p>

          <h3 id="qt-plugin-injection">Qt plugin injection</h3>

          <p>
            According to Wikipedia, Qt is a free and open-source widget toolkit
            for creating GUIs and cross-platform applications, and it seems to
            be used by quite a lot of apps - a simple explorer search for the Qt
            core module revealed at least 9 64-bit apps currently installed on
            my machine:
          </p>

          <p>
            <img
              src="https://i.0x44.cc/b/qtcoredll-explorer-search.png"
              alt=""
            />
          </p>

          <p>
            Most of the modern Qt apps you will find will support a
            <code class="language-plaintext highlighter-rouge"
              >-platformpluginpath</code
            >
            commandline option, which specifies a path to start with while
            loading plugins. What’s interesting here is the fact that SMB shares
            are also supported, which means one can load plugins remotely.
          </p>

          <p>
            So the question here would be, how can we start a Qt app with this
            <code class="language-plaintext highlighter-rouge"
              >-platformpluginpath</code
            >
            argument so we can have it load our malicious plugin?
          </p>

          <p>
            Yes, you guessed that right, URI schemes. In order for us to be able
            to launch an app with our custom input in the commandline, it has to
            have a registered custom URI handler so we can launch it via a
            webpage and have the URI be sent as an argument, here’s what that
            looks like on the registry:
          </p>

          <p>
            <img src="https://i.0x44.cc/b/fdm-regedit.png" alt="" />
            <img src="https://i.0x44.cc/b/fdm-regedit2.png" alt="" />
          </p>

          <p>
            However, there’s a slight problem with this approach (as explained
            in the second blog post I’ve mentionned earlier), and that’s the
            fact that modern browsers tend to apply URL encoding to the URI,
            before the app gets executed, which reduces our chance of pulling
            off the argument injection, since in most cases we would need to
            inject a double-quote to break out of the URI argument.
          </p>

          <p>This is where the Skype Web Plugin comes to play …</p>

          <h3 id="skype-web-plugin">Skype Web Plugin</h3>

          <p>
            When Skype for Web first launched, you could use Skype for instant
            messaging and share multimedia files, but not as a VoIP tool. To
            make voice and video calls in most supported browsers, people had to
            install a plugin.
          </p>

          <p>
            Doing a quick search online revealed the last available version of
            the plugin was 7.32.6.278, which was released sometime in 2017, but
            is still obtainable via their official CDN:
            <a
              href="https://swx.cdn.skype.com/plugin/7.32.6.278/SkypeWebPlugin.msi"
              target="_blank"
              rel="noopener noreferrer"
              >https://swx.cdn.skype.com/plugin/7.32.6.278/SkypeWebPlugin.msi</a
            >
          </p>

          <p>
            After Microsoft introduced plugin-free Skype for Web for their
            supported browsers, they ditched the plugin and dropped support for
            Internet Explorer. However, the plugin remains available in systems
            where previously installed, with the only way to get rid of it being
            a manual uninstall.
          </p>

          <p>
            The ‘Skype Web Plugin’ registers a custom URI handler:
            <code class="language-plaintext highlighter-rouge">swx</code>, which
            launches
            <code class="language-plaintext highlighter-rouge"
              >SkypeShell.exe</code
            >, which is what looks like to be some sort of Internet Explorer
            shell, which means that it uses IE’s rendering engine (mshtml.dll)
            to open webpages.
          </p>

          <p>
            To my surpise, this thing will open any HTTP URL, all you need to do
            is replace
            <code class="language-plaintext highlighter-rouge">http(s)</code>
            with <code class="language-plaintext highlighter-rouge">swx</code>,
            and you have a clickable link that forcefully renders your website
            using mshtml.dll, but here’s the real problem …
          </p>

          <p>
            First of all, protected mode is off by default, so this may
            potentially allow for more attack vectors that I’m currently not
            aware of, since I’m not familiar with what protected mode exactly
            even does, but this certainly doesn’t sound good.
          </p>

          <p>
            <img
              src="https://i.0x44.cc/b/skypeshell-no-protected-mode.png"
              alt=""
            />
          </p>

          <p>
            Secondly (which is what’s more relevant to us), I can load any link
            with a custom URI from within the shell without having the user to
            confirm or know anything.
          </p>

          <p>
            For reference, here’s what trying to exploit a Qt app using plugin
            injection would prompt for, when running IE (11.116.18362.0)
            normally:
          </p>

          <p><img src="https://i.0x44.cc/b/ie-scheme-prompt.png" alt="" /></p>

          <p>
            So not only can we successfully inject arguments regardless of what
            browser the victim uses, we can also spawn a dosen of apps through
            URIs simultaneously.
          </p>

          <h3 id="the-proof-of-concept">The Proof of Concept</h3>

          <p>
            Now that we’ve got a clear idea of the attack vector we will be
            using, we’ll start on the implementation.
          </p>

          <p>
            The first thing we would need to do is find target Qt apps to
            exploit, which are essentially apps that allow loading plugins
            (nearly all of them do), and that have a registered URI handler.
          </p>

          <p>I’ve found 2 of them already installed on my machine:</p>

          <ul>
            <li>
              <a
                href="//freedownloadmanager.org"
                target="_blank"
                rel="noopener noreferrer"
                >Free Download Manager</a
              >
              - The 2nd Google result when searching ‘download manager’.
            </li>
            <li>
              And
              <a href="//origin.com" target="_blank" rel="noopener noreferrer"
                >Origin</a
              >, of course.
            </li>
          </ul>

          <p>
            I’ve tried to find more apps that meet the 2 conditions to verify my
            claims, and sure enough with little to no effort I was able to find
            the
            <a
              href="https://github.com/transmission/transmission"
              target="_blank"
              rel="noopener noreferrer"
              >Transmission</a
            >
            torrent client, which I’m also adding to the list.
          </p>

          <p>
            Like I said earlier, this is not exactly a new thing, 2 months ago
            someone wrote
            <a
              href="https://www.zerodayinitiative.com/blog/2019/4/3/loading-up-a-pair-of-qt-bugs-detailing-cve-2019-1636-and-cve-2019-6739"
              target="_blank"
              rel="noopener noreferrer"
              >this article</a
            >
            explaining how Malwarebytes and Cisco Webex Teams (both of which are
            programs I’ve used before) were found to be vulnerable to this
            attack, but what’s interesting here, is the stealthiness and
            reliability that we can accomplish with the help of the Skype Web
            Plugin …
          </p>

          <p>
            So I started by simply spamming an .html file with iframes that have
            <code class="language-plaintext highlighter-rouge"
              >calculator://</code
            >
            as a src attribute:
          </p>

          <div class="language-html highlighter-rouge">
            <div class="highlight">
              <pre
                class="highlight"
              ><code><span class="nt">&lt;iframe</span> <span class="na">src=</span><span class="s">'calculator://'</span> <span class="na">height=</span><span class="s">"0"</span> <span class="na">frameborder=</span><span class="s">"0"</span><span class="nt">&gt;&lt;/iframe&gt;</span>
<span class="nt">&lt;iframe</span> <span class="na">src=</span><span class="s">'calculator://'</span> <span class="na">height=</span><span class="s">"0"</span> <span class="na">frameborder=</span><span class="s">"0"</span><span class="nt">&gt;&lt;/iframe&gt;</span>
...
</code></pre>
            </div>
          </div>

          <p>And as expected, I soon started to hear my CPU fan …</p>

          <p><img src="https://i.0x44.cc/b/calcspam.gif" alt="" /></p>

          <p>
            So at the very least this can be used for DoS by spam launching
            resource heavy apps, so far so good.
          </p>

          <p>Now on to the code execution…</p>

          <p>
            I’ve fired up Visual Studio and made a quick DLL that shows a
            MessageBox on attach with the process file name as a message.
          </p>

          <p>To make our .dll loadable by Qt, we have to:</p>
          <ul>
            <li>
              <strong
                >Add a
                <code class="language-plaintext highlighter-rouge"
                  >.qtmetad</code
                >
                section with valid plugin metadata:</strong
              >
              We make VS generate an empty one that we’ll fill out manually with
              a hex editor using content from the original plugin.
            </li>
            <li>
              <strong>Find a plugin we can override:</strong>
              There’s this one called the Windows Integration Plugin
              (qwindows.dll) which all apps seem to require in order to run on
              Windows.
            </li>
          </ul>

          <p>
            To make this stealthy, I’ve added an
            <code class="language-plaintext highlighter-rouge"
              >ExitProcess()</code
            >
            right after the DLL is done executing to prevent the target app from
            showing up, so as of this stage there’s no visible interruption
            (besides the Skype shell) and the user won’t notice anything.
          </p>

          <p>
            Now all that’s left for us to have is an SMB share that will host
            our malicous plugins.
          </p>

          <p>
            Here’s a detailed video of the PoC in action, from crafting the .dll
            files to the MessageBox on the 3 apps:
          </p>

          <p
            style="
              position: relative;
              padding: 30px 0px 57% 0px;
              height: 0;
              overflow: hidden;
            "
          >
            <iframe
              src="https://www.youtube.com/embed/xVZU-2Y0Pzc"
              width="100%"
              height="100%"
              frameborder="0"
              allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
              allowfullscreen=""
              style="
                display: block;
                margin: 0px auto;
                position: absolute;
                top: 0;
                left: 0;
              "
            ></iframe>
          </p>

          <h3 id="dos-bonus">DoS Bonus</h3>

          <p>
            I’ve come across this URI
            <code class="language-plaintext highlighter-rouge"
              >ms-cxh-full://</code
            >
            that seems to be the fullscreen version of
            <code class="language-plaintext highlighter-rouge">ms-cxh://</code>
            which is something used in Microsoft account setup, but what’s
            interesting is that this one can cause a black screen that can’t be
            dismissed, forcing the user to sign out/reboot.
            <a href="ms-cxh-full://">⚠️ Try at your own risk ⚠️</a>
          </p>

          <p>
            <strong><em>Update (10/2020)</em></strong
            >: Since I’ve noticed a recent surge in the malicious usage of this
            particular URI scheme, I’ve added simple steps you can follow, in
            case you need to recover your Windows 10 session, after an
            unintended click:
          </p>
          <ol>
            <li>Press Ctrl + Shift + Esc to invoke the Task Manager.</li>
            <li>
              You can use Alt + Tab to peek at open windows, but make sure to
              keep the Task Manager window focused, after you do so.
            </li>
            <li>
              If the Task Manager is in
              <a
                href="https://i.0x44.cc/b/taskmgr-simple.png"
                target="_blank"
                rel="noopener noreferrer"
                >‘simple view’</a
              >: Hit Tab, then Space - so that it switches to
              <a
                href="https://i.0x44.cc/b/taskmgr-expand.png"
                target="_blank"
                rel="noopener noreferrer"
                >‘expanded view’</a
              >.
            </li>
            <li>
              Blindly type the following on your keyboard (including the space):
              <code class="language-plaintext highlighter-rouge">user oobe</code
              >, in order to highlight the offending process.
            </li>
            <li>Hit the Delete keyboard key, to end it.</li>
          </ol>

          <h3 id="update-062019">Update (06/2019)</h3>

          <p>
            Microsoft released the
            <a
              href="https://support.microsoft.com/en-us/help/4503293/windows-10-update-kb4503293"
              target="_blank"
              rel="noopener noreferrer"
              >KB4503293</a
            >
            cumulative update for Windows 10 version 1903 on June 11 of 2019,
            which updated Internet Explorer from .116 to .175, which includes
            sanitization for URI scheme links to prevent command-line argument
            injection:
          </p>

          <p align="center">
            <img src="https://i.0x44.cc/b/ie-scheme-prompt-new.png" /> Internet
            Explorer 11.175.18362.0
          </p>

          <p>
            As a result, this attack is no longer feasible on an up-to-date
            Windows system.
          </p>

          <p>
            <a
              href="https://github.com/thedroidgeek/0x44.cc/commits/master/_posts/2019-05-28-skype-web-plugin-ez-rce.md"
              target="_blank"
              rel="noopener noreferrer"
              >(edited)</a
            >
          </p>

          <div class="post-tags"></div>
        </div>

        <br />
        <table class="kofi-btn">
          <tbody>
            <tr>
              <td>
                <p align="right">
                  If you've enjoyed this article, feel free to
                </p>
              </td>
              <td>
                <a href="https://ko-fi.com/annan" target="_blank">
                  <img
                    src="/assets/media/kofi.png"
                    alt="Buy Me a Coffee at ko-fi.com"
                  />
                </a>
              </td>
            </tr>
          </tbody>
        </table>

        <section class="comments">
          <h2>Comments</h2>

          <div id="disqus_thread">
            <button class="disqus-load" onClick="loadDisqusComments()">
              Load Comments
            </button>
          </div>
          <script src="/assets/js/disqusloader.min.js"></script>
          <script>
            /**
             *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW
             *  TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
             *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT:s
             *  https://disqus.com/admin/universalcode/#configuration-variables
             */
            var disqus_config = function () {
              this.page.url =
                "https://0x44.cc/infosec/2019/05/28/skype-web-plugin-ez-rce.html";
              this.page.identifier =
                "" ||
                "https://0x44.cc/infosec/2019/05/28/skype-web-plugin-ez-rce.html";
              // hack: preserve old comments by using old domain
              this.page.url = this.page.url.replace(
                "https://0x44.cc",
                "https://0x41.cf"
              );
              this.page.identifier = this.page.identifier.replace(
                "https://0x44.cc",
                "https://0x41.cf"
              );
            };
            function loadDisqusComments() {
              // DON'T EDIT BELOW THIS LINE
              var d = document,
                s = d.createElement("script");
              s.src = "//0x41-cf.disqus.com/embed.js";
              s.setAttribute("data-timestamp", +new Date());
              (d.head || d.body).appendChild(s);
            }

            // Disqus lazy-loading (on visibility)
            disqusLoader("#disqus_thread", {
              scriptUrl: "//0x41-cf.disqus.com/embed.js",
              disqusConfig: disqus_config,
            });
          </script>
          <noscript>
            Please enable JavaScript to view the
            <a href="https://disqus.com/?ref_noscript"
              >comments powered by Disqus</a
            >.
          </noscript>
        </section>

        <section class="related">
          <h2>Related Posts</h2>
          <ul class="posts-list">
            <li>
              <h3>
                <a
                  href="/reversing/2021/07/21/reversing-x86-and-c-code-for-beginners.html"
                >
                  Reversing for dummies - x86 assembly and C code (Beginner/ADHD
                  friendly)
                  <small>&bull; 21 Jul 2021</small>
                </a>
              </h3>
            </li>

            <li>
              <h3>
                <a
                  href="/automation/2021/03/02/google-assistant-youtube-smart-tvs.html"
                >
                  Google Assistant YouTube command for smart TVs
                  <small>&bull; 02 Mar 2021</small>
                </a>
              </h3>
            </li>

            <li>
              <h3>
                <a href="/reversing/2019/10/08/unlocking-nokia-g240wa.html">
                  Unlocking IAM's Nokia G-240W-A router (Part 1)
                  <small>&bull; 08 Oct 2019</small>
                </a>
              </h3>
            </li>
          </ul>
        </section>
      </div>
    </main>

    <!-- Optional footer content -->
  </body>
</html>
