<!DOCTYPE html>
<html lang="en-us">
  <head>
    <link href="https://gmpg.org/xfn/11" rel="profile" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />

    <!-- Enable responsiveness on mobile devices-->
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1"
    />

    <title>
      Unlocking IAM's Nokia G-240W-A router (Part 1) &middot; 0x41.cf
    </title>

    <!-- CSS -->
    <link rel="stylesheet" href="/assets/css/main.css" />

    <!-- Icons -->
    <link
      rel="apple-touch-icon-precomposed"
      sizes="144x144"
      href="/favicon.png"
    />
    <link rel="shortcut icon" href="/favicon.ico" />

    <!-- RSS -->
    <link
      rel="alternate"
      type="application/rss+xml"
      title="RSS"
      href="/feed.xml"
    />

    <!-- Additional head bits without overriding original head -->
  </head>

  <body class="post">
    <script src="/assets/js/anchor.min.js"></script>
    <script>
      // IE support
      if (window.MSInputMethodContext && document.documentMode) {
        document.write(
          '<script src="/assets/js/ie11CustomProperties.min.js"><\x2fscript>'
        );
      }
      // progress bar
      prog = document.createElement("div");
      prog.setAttribute("id", "progress-bar");
      prog.style.setProperty("--progress", "0%");
      document.body.insertBefore(prog, document.body.childNodes[0]);
      const article = document.querySelector(".post");
      const progressBar = document.querySelector("#progress-bar");
      document.addEventListener("scroll", function () {
        const articleScroll = pageYOffset - article.offsetTop;
        const height =
          document.documentElement.scrollHeight -
          innerHeight -
          article.offsetTop;
        const readPercent = (articleScroll / height) * 100;
        if (readPercent > 0) {
          progressBar.style.setProperty("--progress", readPercent + "%");
        } else {
          progressBar.style.setProperty("--progress", "0%");
        }
      });

      // initialize AnchorJS
      document.addEventListener("DOMContentLoaded", function (event) {
        anchors.add(".post-body h3, .post-body h4");
        anchors.options.placement = "left";
      });
    </script>

    <div id="sidebar">
      <header>
        <div class="site-title">
          <a href="/">
            <span class="back-arrow icon"
              ><svg
                fill="#000000"
                height="24"
                viewBox="0 0 24 24"
                width="24"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path d="M0 0h24v24H0z" fill="none" />
                <path
                  d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"
                /></svg
            ></span>

            <span id="site-title">0x41.cf</span>
          </a>
        </div>
        <p class="lead">InfoSec, Reverse Engineering, and more (soon&trade;)</p>
      </header>
      <nav id="sidebar-nav-links">
        <a class="home-link" href="/">Home</a>

        <a class="page-link" href="/about.html">whoami</a>

        <a class="category-link" href="/infosec/">InfoSec</a>

        <a class="category-link" href="/reversing/">Reverse Engineering</a>

        <a class="category-link" href="/automation/">Automation</a>

        <!-- Optional additional links to insert in sidebar nav -->
      </nav>

      <nav id="sidebar-icon-links">
        <a
          id="subscribe-link"
          class="icon"
          title="Subscribe"
          aria-label="Subscribe"
          href="/feed.xml"
        >
          <svg
            fill="#000000"
            height="24"
            viewBox="0 0 24 24"
            width="24"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path d="M0 0h24v24H0z" fill="none" />
            <circle cx="6.18" cy="17.82" r="2.18" />
            <path
              d="M4 4.44v2.83c7.03 0 12.73 5.7 12.73 12.73h2.83c0-8.59-6.97-15.56-15.56-15.56zm0 5.66v2.83c3.9 0 7.07 3.17 7.07 7.07h2.83c0-5.47-4.43-9.9-9.9-9.9z"
            />
          </svg>
        </a>

        <a
          id="github-link"
          class="icon"
          title="GitHub"
          aria-label="GitHub"
          href="https://github.com/thedroidgeek"
          target="_blank"
          rel="noopener noreferrer"
        >
          <svg
            version="1.1"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            height="24"
            width="24"
          >
            <path
              d="M12 2c6.625 0 12 5.375 12 12 0 5.297-3.437 9.797-8.203 11.391-0.609 0.109-0.828-0.266-0.828-0.578 0-0.391 0.016-1.687 0.016-3.297 0-1.125-0.375-1.844-0.812-2.219 2.672-0.297 5.484-1.313 5.484-5.922 0-1.313-0.469-2.375-1.234-3.219 0.125-0.313 0.531-1.531-0.125-3.187-1-0.313-3.297 1.234-3.297 1.234-0.953-0.266-1.984-0.406-3-0.406s-2.047 0.141-3 0.406c0 0-2.297-1.547-3.297-1.234-0.656 1.656-0.25 2.875-0.125 3.187-0.766 0.844-1.234 1.906-1.234 3.219 0 4.594 2.797 5.625 5.469 5.922-0.344 0.313-0.656 0.844-0.766 1.609-0.688 0.313-2.438 0.844-3.484-1-0.656-1.141-1.844-1.234-1.844-1.234-1.172-0.016-0.078 0.734-0.078 0.734 0.781 0.359 1.328 1.75 1.328 1.75 0.703 2.141 4.047 1.422 4.047 1.422 0 1 0.016 1.937 0.016 2.234 0 0.313-0.219 0.688-0.828 0.578-4.766-1.594-8.203-6.094-8.203-11.391 0-6.625 5.375-12 12-12zM4.547 19.234c0.031-0.063-0.016-0.141-0.109-0.187-0.094-0.031-0.172-0.016-0.203 0.031-0.031 0.063 0.016 0.141 0.109 0.187 0.078 0.047 0.172 0.031 0.203-0.031zM5.031 19.766c0.063-0.047 0.047-0.156-0.031-0.25-0.078-0.078-0.187-0.109-0.25-0.047-0.063 0.047-0.047 0.156 0.031 0.25 0.078 0.078 0.187 0.109 0.25 0.047zM5.5 20.469c0.078-0.063 0.078-0.187 0-0.297-0.063-0.109-0.187-0.156-0.266-0.094-0.078 0.047-0.078 0.172 0 0.281s0.203 0.156 0.266 0.109zM6.156 21.125c0.063-0.063 0.031-0.203-0.063-0.297-0.109-0.109-0.25-0.125-0.313-0.047-0.078 0.063-0.047 0.203 0.063 0.297 0.109 0.109 0.25 0.125 0.313 0.047zM7.047 21.516c0.031-0.094-0.063-0.203-0.203-0.25-0.125-0.031-0.266 0.016-0.297 0.109s0.063 0.203 0.203 0.234c0.125 0.047 0.266 0 0.297-0.094zM8.031 21.594c0-0.109-0.125-0.187-0.266-0.172-0.141 0-0.25 0.078-0.25 0.172 0 0.109 0.109 0.187 0.266 0.172 0.141 0 0.25-0.078 0.25-0.172zM8.937 21.438c-0.016-0.094-0.141-0.156-0.281-0.141-0.141 0.031-0.234 0.125-0.219 0.234 0.016 0.094 0.141 0.156 0.281 0.125s0.234-0.125 0.219-0.219z"
            ></path>
          </svg>
        </a>

        <a
          id="linkedin-link"
          class="icon"
          title="LinkedIn"
          aria-label="LinkedIn"
          href="https://linkedin.com/in/thedroidgeek"
          target="_blank"
          rel="noopener"
        >
          <svg
            version="1.1"
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            height="24"
            width="24"
          >
            <path
              d="M 24.007812 14.597656 L 24.007812 23.472656 L 18.859375 23.472656 L 18.859375 15.191406 C 18.859375 13.113281 18.117188 11.691406 16.253906 11.691406 C 14.832031 11.691406 13.988281 12.648438 13.613281 13.574219 C 13.480469 13.90625 13.445312 14.367188 13.445312 14.828125 L 13.445312 23.472656 L 8.296875 23.472656 C 8.296875 23.472656 8.367188 9.449219 8.296875 7.996094 L 13.441406 7.996094 L 13.441406 10.1875 C 13.433594 10.207031 13.417969 10.222656 13.410156 10.238281 L 13.441406 10.238281 L 13.441406 10.1875 C 14.128906 9.136719 15.347656 7.632812 18.082031 7.632812 C 21.46875 7.632812 24.007812 9.84375 24.007812 14.597656 Z M 2.914062 0.535156 C 1.152344 0.535156 0 1.6875 0 3.207031 C 0 4.691406 1.117188 5.882812 2.84375 5.882812 L 2.878906 5.882812 C 4.671875 5.882812 5.789062 4.691406 5.789062 3.207031 C 5.757812 1.6875 4.671875 0.535156 2.914062 0.535156 Z M 0.304688 23.472656 L 5.449219 23.472656 L 5.449219 7.996094 L 0.304688 7.996094 Z M 0.304688 23.472656 "
            />
          </svg>
        </a>
      </nav>

      <p>
        &copy; 2024.
        <a href="/LICENSE.md">MIT License.</a>
      </p>
    </div>

    <main class="container">
      <header>
        <h1 class="post-title">
          Unlocking IAM's Nokia G-240W-A router (Part 1)
        </h1>
      </header>
      <div class="content">
        <div class="post-meta">
          <span class="post-date">08 Oct 2019</span>
          <span class="post-categories">
            &bull;

            <a href="/reversing/">
              <svg
                version="1.1"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 24 24"
                height="24"
                width="24"
              >
                <path
                  d="M 23.703125 13 C 23.515625 12.808594 23.289062 12.714844 23.03125 12.714844 L 19.671875 12.714844 L 19.671875 8.308594 L 22.265625 5.710938 C 22.457031 5.523438 22.550781 5.296875 22.550781 5.039062 C 22.550781 4.777344 22.457031 4.554688 22.265625 4.363281 C 22.074219 4.171875 21.851562 4.078125 21.589844 4.078125 C 21.332031 4.078125 21.105469 4.171875 20.917969 4.363281 L 18.324219 6.957031 L 5.667969 6.957031 L 3.074219 4.363281 C 2.882812 4.171875 2.660156 4.078125 2.398438 4.078125 C 2.140625 4.078125 1.914062 4.171875 1.722656 4.363281 C 1.535156 4.554688 1.4375 4.777344 1.4375 5.039062 C 1.4375 5.296875 1.535156 5.523438 1.722656 5.710938 L 4.316406 8.308594 L 4.316406 12.714844 L 0.960938 12.714844 C 0.699219 12.714844 0.476562 12.808594 0.285156 13 C 0.09375 13.191406 0 13.414062 0 13.675781 C 0 13.933594 0.09375 14.160156 0.285156 14.347656 C 0.476562 14.539062 0.699219 14.632812 0.960938 14.632812 L 4.316406 14.632812 C 4.316406 16.234375 4.609375 17.601562 5.1875 18.742188 L 2.160156 22.144531 C 1.988281 22.347656 1.910156 22.578125 1.925781 22.84375 C 1.941406 23.109375 2.042969 23.332031 2.234375 23.511719 C 2.425781 23.671875 2.640625 23.75 2.878906 23.75 C 3.160156 23.75 3.398438 23.644531 3.597656 23.4375 L 6.34375 20.332031 L 6.566406 20.542969 C 6.707031 20.671875 6.925781 20.835938 7.21875 21.027344 C 7.515625 21.222656 7.84375 21.417969 8.210938 21.613281 C 8.574219 21.808594 9.007812 21.972656 9.511719 22.109375 C 10.019531 22.242188 10.527344 22.3125 11.035156 22.3125 L 11.035156 8.878906 L 12.953125 8.878906 L 12.953125 22.3125 C 13.433594 22.3125 13.917969 22.246094 14.410156 22.117188 C 14.898438 21.988281 15.308594 21.839844 15.640625 21.683594 C 15.96875 21.523438 16.292969 21.339844 16.613281 21.132812 C 16.933594 20.929688 17.144531 20.789062 17.242188 20.707031 C 17.34375 20.625 17.417969 20.5625 17.46875 20.511719 L 20.4375 23.464844 C 20.617188 23.65625 20.839844 23.75 21.113281 23.75 C 21.382812 23.75 21.605469 23.65625 21.785156 23.464844 C 21.976562 23.277344 22.070312 23.050781 22.070312 22.792969 C 22.070312 22.53125 21.976562 22.304688 21.785156 22.117188 L 18.667969 18.984375 C 19.335938 17.792969 19.671875 16.34375 19.671875 14.632812 L 23.03125 14.632812 C 23.289062 14.632812 23.515625 14.539062 23.707031 14.347656 C 23.894531 14.160156 23.992188 13.933594 23.992188 13.675781 C 23.992188 13.414062 23.894531 13.191406 23.703125 13 Z M 23.703125 13 "
                />
                <path
                  d="M 15.390625 1.640625 C 14.457031 0.707031 13.324219 0.238281 11.996094 0.238281 C 10.664062 0.238281 9.535156 0.707031 8.597656 1.640625 C 7.664062 2.578125 7.199219 3.707031 7.199219 5.039062 L 16.792969 5.039062 C 16.792969 3.710938 16.324219 2.578125 15.390625 1.640625 Z M 15.390625 1.640625 "
                />
              </svg>

              Reverse Engineering
            </a>
          </span>
        </div>

        <div class="post-body">
          <h3 id="context">Context</h3>

          <p>
            As we recently upgraded our home internet to try out Maroc Telecom’s
            100mbps fiber offer, I’ve noticed that the Nokia router they
            installed had horrible Wi-Fi speed - the max I could to get standing
            next to it was around 60mbps down, while in the opposite room, the
            speed was always under 10mbps.
          </p>

          <p>
            What’s interesting is the fact that it had decent range - I get full
            bars most of the time, and my Wi-Fi adapter reports a 300mbps data
            rate.
          </p>

          <p>
            This got me intrigued, so I tried to take a look at what’s running
            inside this thing.
          </p>

          <p><img src="https://i.0x41.cf/b/nokia-g-240w-a.png" alt="" /></p>

          <h3 id="first-look">First look</h3>

          <p>
            Doing a little online research, you will find out that the firmware
            on this router had quite a
            <a
              href="https://medium.com/tenable-techblog/gpon-home-gateway-rce-threatens-tens-of-thousands-users-c4a17fd25b97"
              target="_blank"
              rel="noopener noreferrer"
              >bad</a
            >
            <a
              href="https://www.websec.ca/publication/Blog/backdoors-in-Zhone-GPON-2520-and-Alcatel-Lucent-I240Q"
              target="_blank"
              rel="noopener noreferrer"
              >history</a
            >.
          </p>

          <p>
            There’s various blog posts showing that routers running on similar
            firmware were found to be vulnerable to unauthenticated RCE
            vulnerabilities, and had hardcoded Telnet backdoor accounts.
          </p>

          <p>
            The first thing I did, of course, is log into the web administration
            portal - there’s a sticker in the back of the router with the
            credentials, which seem device specific, which is good… Or so I
            thought - as it turns out there’s a known ‘superuser’ account for
            the web panel, which has a default password: AdminGPON / ALC#FGU
          </p>

          <p><img src="https://i.0x41.cf/b/nokia-ont-back.png" alt="" /></p>

          <p>
            After fiddling with the web interface, trying to force the WiFi to
            use 802.11n and 40MHz bandwidth, I’ve noticed no difference. It was
            time to take a deeper dive.
          </p>

          <p>
            According to someone at
            <a
              href="https://lafibre.info/cryptographie/probleme-dacces-en-ligne-de-commande-a-mon-ont/"
              target="_blank"
              rel="noopener noreferrer"
              >lafibre.info</a
            >
            forum, Telnet access to this router was possible via the ONTUSER /
            SUGAR2A041 ‘backdoor’ account, before an update was deployed
            sometime in June 2018.
          </p>

          <p>
            I’ve tried the web account credentials as well as any backdoor
            credentials I was able to find, to no avail. The fact that Telnet
            access locks for 5 minutes every 3 failed attempts didn’t help as
            well.
          </p>

          <p>
            That’s when I’ve decided to take a look at the configuration backup
            and restore functionnality.
          </p>

          <h3 id="analysing-the-backup-file">Analysing the backup file</h3>

          <p>
            As the ‘AdminGPON’ user, you’re able to import and export the router
            configuration.
          </p>

          <p>
            <img
              src="https://i.0x41.cf/b/nokia-ont-backup-restore.png"
              alt=""
            />
          </p>

          <p>
            As the exported config.cfg file wasn’t plain-text, I’ve tried
            looking for magic values, and binwalk was able to find something
            right away:
          </p>
          <div class="language-plaintext highlighter-rouge">
            <div class="highlight">
              <pre class="highlight"><code>$ binwalk config.cfg

DECIMAL     HEXADECIMAL   DESCRIPTION
--------------------------------------------------------------------
20          0x14          Zlib compressed data, default compression
</code></pre>
            </div>
          </div>

          <p>
            Being the lazy guy that I am, I’ve opened the file in a hex editor,
            stripped out the first 20 bytes, then pasted the hex dump in
            <a
              href="https://gchq.github.io/CyberChef/"
              target="_blank"
              rel="noopener noreferrer"
              >CyberChef</a
            >, and a huge xml file showed up. Bingo!
          </p>

          <p><img src="https://i.0x41.cf/b/cyberchef-zlib.png" alt="" /></p>

          <p>
            Exploring the xml a bit, I was able to spot the Telnet credentials
            (or so I thought):
          </p>

          <div class="language-xml highlighter-rouge">
            <div class="highlight">
              <pre
                class="highlight"
              ><code><span class="nt">&lt;TelnetEnable</span> <span class="na">rw=</span><span class="s">"RW"</span> <span class="na">t=</span><span class="s">"boolean"</span> <span class="na">v=</span><span class="s">"True"</span><span class="nt">&gt;&lt;/TelnetEnable&gt;</span>
<span class="nt">&lt;TelnetUserName</span> <span class="na">ml=</span><span class="s">"256"</span> <span class="na">rw=</span><span class="s">"RW"</span> <span class="na">t=</span><span class="s">"string"</span> <span class="na">v=</span><span class="s">"admin"</span><span class="nt">&gt;&lt;/TelnetUserName&gt;</span>
<span class="nt">&lt;TelnetPassword</span> <span class="na">ml=</span><span class="s">"256"</span> <span class="na">rw=</span><span class="s">"RW"</span> <span class="na">t=</span><span class="s">"string"</span> <span class="na">v=</span><span class="s">"OYdLWUVDdKQTPaCIeTqniA=="</span> <span class="na">ealgo=</span><span class="s">"ab"</span><span class="nt">&gt;&lt;/TelnetPassword&gt;</span>
</code></pre>
            </div>
          </div>

          <p>Alrighty, now how do I crack/decrypt this admin password?</p>

          <p>
            Since this was 128-bit base64 encoded data, I tried MD5’ing known
            passwords, then I tried every other known hashing algorithm, but
            none of them gave me anything - so it has to be either salted or
            encryption.
          </p>

          <p>
            Exploring a little further, I’ve found another Telnet credential
            thingy:
          </p>

          <div class="language-xml highlighter-rouge">
            <div class="highlight">
              <pre
                class="highlight"
              ><code><span class="nt">&lt;TelnetSshAccount.</span> <span class="na">n=</span><span class="s">"TelnetSshAccount"</span> <span class="na">t=</span><span class="s">"staticObject"</span><span class="nt">&gt;</span>
<span class="nt">&lt;Enable</span> <span class="na">rw=</span><span class="s">"RW"</span> <span class="na">t=</span><span class="s">"boolean"</span> <span class="na">v=</span><span class="s">"False"</span><span class="nt">&gt;&lt;/Enable&gt;</span>
<span class="nt">&lt;UserName</span> <span class="na">ml=</span><span class="s">"64"</span> <span class="na">rw=</span><span class="s">"RW"</span> <span class="na">t=</span><span class="s">"string"</span> <span class="na">v=</span><span class="s">""</span><span class="nt">&gt;&lt;/UserName&gt;</span>
<span class="nt">&lt;Password</span> <span class="na">ml=</span><span class="s">"64"</span> <span class="na">rw=</span><span class="s">"RW"</span> <span class="na">t=</span><span class="s">"string"</span> <span class="na">v=</span><span class="s">""</span> <span class="na">ealgo=</span><span class="s">"ab"</span><span class="nt">&gt;&lt;/Password&gt;</span>
<span class="nt">&lt;/TelnetSshAccount.&gt;</span>
</code></pre>
            </div>
          </div>

          <p>But it’s unused… Damn.</p>

          <p>
            Now that modifying the configuration file seemed more necessary, I
            tried to take a second look at the exported config.cfg.
          </p>

          <h3 id="modifying-the-backup-file">Modifying the backup file</h3>

          <p>
            I kept exporting backup files while changing the router settings to
            regenerate different files for me to look at.
          </p>

          <p>
            After a few comparisons with the not so naked eye (I wear glasses),
            I was able to tell that a single 32-bit value in the header was
            always changing radically, so this must be a checksum of sorts.
          </p>

          <p>
            <img src="https://i.0x41.cf/b/cfg-header-comparison.gif" alt="" />
          </p>

          <p>
            Now before guessing what’s being checksumed and how, I first need to
            know where the zlib data ends and if there’s something else after
            it.
          </p>

          <p>
            So I tried recreating the compressed chunk, which was pretty
            trivial, again thanks to CyberChef.
          </p>

          <p>
            It turns out there’s about 300 bytes after it that are unknown, but
            still, CRC32 on the deflated data gave the exact value at offset 8,
            which was in big endian. Yay!
          </p>

          <p>
            Now the null bytes made more sense, and it was clear to me that the
            other values next to the checksum must be positive integers.
          </p>

          <p>
            Soon after, I was able to figure out that the first one (+4) was the
            length of the deflated data, while the second one (+C) was the size
            of the xml file.
          </p>

          <p>
            Since in all the config.cfg files that I’ve exported, the rest of
            the bytes were static, this seemed enough for me to generate my own
            backup file, and as expected, uploading my crafted config.cfg
            worked!
          </p>

          <p>
            Here’s a
            <a
              href="https://gist.github.com/thedroidgeek/80c379aa43b71015d71da130f85a435a"
              target="_blank"
              rel="noopener noreferrer"
              >simple python script</a
            >
            I’ve made for this purpose, for those interested.
          </p>

          <h3 id="unlocking-telnet-and-ssh-access">
            Unlocking Telnet and SSH access
          </h3>

          <p>
            So I took the password that I’ve set for the the ‘AdminGPON’ web
            account from:
          </p>

          <div class="language-xml highlighter-rouge">
            <div class="highlight">
              <pre
                class="highlight"
              ><code><span class="nt">&lt;WebAccount.</span> <span class="na">n=</span><span class="s">"WebAccount"</span> <span class="na">t=</span><span class="s">"staticObject"</span><span class="nt">&gt;</span>
<span class="nt">&lt;Enable</span> <span class="na">rw=</span><span class="s">"RW"</span> <span class="na">t=</span><span class="s">"boolean"</span> <span class="na">v=</span><span class="s">"True"</span><span class="nt">&gt;&lt;/Enable&gt;</span>
<span class="nt">&lt;Priority</span> <span class="na">max=</span><span class="s">"10"</span> <span class="na">min=</span><span class="s">"1"</span> <span class="na">rw=</span><span class="s">"RW"</span> <span class="na">t=</span><span class="s">"unsignedInt"</span> <span class="na">v=</span><span class="s">"1"</span><span class="nt">&gt;&lt;/Priority&gt;</span>
<span class="nt">&lt;UserName</span> <span class="na">ml=</span><span class="s">"64"</span> <span class="na">rw=</span><span class="s">"RW"</span> <span class="na">t=</span><span class="s">"string"</span> <span class="na">v=</span><span class="s">"AdminGPON"</span><span class="nt">&gt;&lt;/UserName&gt;</span>
<span class="nt">&lt;Password</span> <span class="na">ml=</span><span class="s">"64"</span> <span class="na">rw=</span><span class="s">"RW"</span> <span class="na">t=</span><span class="s">"string"</span> <span class="na">v=</span><span class="s">"[REDACTED]"</span> <span class="na">ealgo=</span><span class="s">"ab"</span><span class="nt">&gt;&lt;/Password&gt;</span>
<span class="nt">&lt;PresetPassword</span> <span class="na">ml=</span><span class="s">"64"</span> <span class="na">rw=</span><span class="s">"R"</span> <span class="na">t=</span><span class="s">"string"</span> <span class="na">v=</span><span class="s">"xEKUBYh1yT50dQFNwAr/5A=="</span> <span class="na">ealgo=</span><span class="s">"ab"</span><span class="nt">&gt;&lt;/PresetPassword&gt;</span>
<span class="nt">&lt;/WebAccount.&gt;</span>
</code></pre>
            </div>
          </div>

          <p>
            And used it for
            <code class="language-plaintext highlighter-rouge"
              >TelnetPassword</code
            >
            config node, but logging in as
            <code class="language-plaintext highlighter-rouge">admin</code>
            still didn’t work.
          </p>

          <p>
            Since I can now generate these password hashes (or whatever they
            are) also, I tried changing my ‘AdminGPON’ password and comparing
            the resulting value with the
            <code class="language-plaintext highlighter-rouge"
              >TelnetPassword</code
            >
            one (<code class="language-plaintext highlighter-rouge"
              >OYdLWUVDdKQTPaCIeTqniA==</code
            >), and after a couple of tries, I’ve realized that the password was
            simply:
            <code class="language-plaintext highlighter-rouge">admin</code>.
          </p>

          <p>
            Since we all know that admin:admin is the first login combo that I,
            and everyone else, use, when trying to login on any panel that’s not
            ours, it seems like they now ignore these credentials.
          </p>

          <p>
            But don’t worry,
            <code class="language-plaintext highlighter-rouge"
              >TelnetSshAccount</code
            >
            comes to the rescue:
          </p>

          <div class="language-xml highlighter-rouge">
            <div class="highlight">
              <pre
                class="highlight"
              ><code><span class="nt">&lt;TelnetSshAccount.</span> <span class="na">n=</span><span class="s">"TelnetSshAccount"</span> <span class="na">t=</span><span class="s">"staticObject"</span><span class="nt">&gt;</span>
<span class="nt">&lt;Enable</span> <span class="na">rw=</span><span class="s">"RW"</span> <span class="na">t=</span><span class="s">"boolean"</span> <span class="na">v=</span><span class="s">"True"</span><span class="nt">&gt;&lt;/Enable&gt;</span>
<span class="nt">&lt;UserName</span> <span class="na">ml=</span><span class="s">"64"</span> <span class="na">rw=</span><span class="s">"RW"</span> <span class="na">t=</span><span class="s">"string"</span> <span class="na">v=</span><span class="s">"hexdd"</span><span class="nt">&gt;&lt;/UserName&gt;</span>
<span class="nt">&lt;Password</span> <span class="na">ml=</span><span class="s">"64"</span> <span class="na">rw=</span><span class="s">"RW"</span> <span class="na">t=</span><span class="s">"string"</span> <span class="na">v=</span><span class="s">"[REDACTED]"</span> <span class="na">ealgo=</span><span class="s">"ab"</span><span class="nt">&gt;&lt;/Password&gt;</span>
<span class="nt">&lt;/TelnetSshAccount.&gt;</span>
</code></pre>
            </div>
          </div>

          <p>
            I’ve set the ‘Enable’ flag to true, chose a username, and copied my
            password, and lo and behold, after a reboot, we have root!
          </p>

          <p><img src="https://i.0x41.cf/b/root-nokia-ont.png" alt="" /></p>

          <p>Stay tuned for more. :)</p>

          <div class="post-tags"></div>
        </div>

        <br />
        <table class="kofi-btn">
          <tbody>
            <tr>
              <td>
                <p align="right">
                  If you've enjoyed this article, feel free to
                </p>
              </td>
              <td>
                <a href="https://ko-fi.com/annan" target="_blank">
                  <img
                    src="/assets/media/kofi.png"
                    alt="Buy Me a Coffee at ko-fi.com"
                  />
                </a>
              </td>
            </tr>
          </tbody>
        </table>

        <section class="comments">
          <h2>Comments</h2>

          <div id="disqus_thread">
            <button class="disqus-load" onClick="loadDisqusComments()">
              Load Comments
            </button>
          </div>
          <script src="/assets/js/disqusloader.min.js"></script>
          <script>
            /**
             *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW
             *  TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
             *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT:s
             *  https://disqus.com/admin/universalcode/#configuration-variables
             */
            var disqus_config = function () {
              this.page.url =
                "https://0x41.cf/reversing/2019/10/08/unlocking-nokia-g240wa.html";
              this.page.identifier =
                "" ||
                "https://0x41.cf/reversing/2019/10/08/unlocking-nokia-g240wa.html";
            };
            function loadDisqusComments() {
              // DON'T EDIT BELOW THIS LINE
              var d = document,
                s = d.createElement("script");
              s.src = "//0x41-cf.disqus.com/embed.js";
              s.setAttribute("data-timestamp", +new Date());
              (d.head || d.body).appendChild(s);
            }

            // Disqus lazy-loading (on visibility)
            disqusLoader("#disqus_thread", {
              scriptUrl: "//0x41-cf.disqus.com/embed.js",
            });
          </script>
          <noscript>
            Please enable JavaScript to view the
            <a href="https://disqus.com/?ref_noscript"
              >comments powered by Disqus</a
            >.
          </noscript>
        </section>

        <section class="related">
          <h2>Related Posts</h2>
          <ul class="posts-list">
            <li>
              <h3>
                <a
                  href="/reversing/2021/07/21/reversing-x86-and-c-code-for-beginners.html"
                >
                  Reversing for dummies - x86 assembly and C code (Beginner/ADHD
                  friendly)
                  <small>&bull; 21 Jul 2021</small>
                </a>
              </h3>
            </li>

            <li>
              <h3>
                <a
                  href="/automation/2021/03/02/google-assistant-youtube-smart-tvs.html"
                >
                  Google Assistant YouTube command for smart TVs
                  <small>&bull; 02 Mar 2021</small>
                </a>
              </h3>
            </li>

            <li>
              <h3>
                <a href="/infosec/2019/05/28/skype-web-plugin-ez-rce.html">
                  1-click RCE with Skype Web Plugin and Qt apps
                  <small>&bull; 28 May 2019</small>
                </a>
              </h3>
            </li>
          </ul>
        </section>
      </div>
    </main>

    <!-- Optional footer content -->
  </body>
</html>
